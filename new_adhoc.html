<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enter New Adhoc</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
    <script>
        function saveAdhocData(event) {
            event.preventDefault();

            const login = document.getElementById('login').value.trim();
            const activityName = document.getElementById('activityName').value.trim();
            const date = document.getElementById('date').value;
            const duration = document.getElementById('duration').value.trim();
            const errorMessage = document.getElementById('error-message');
            const successMessage = document.getElementById('success-message');

            if (!login || !activityName || !date || !duration) {
                errorMessage.textContent = "All fields are required.";
                errorMessage.style.display = "block";
                successMessage.style.display = "none";
                return;
            }

            if (isNaN(duration) || duration <= 0) {
                errorMessage.textContent = "Please enter a valid duration in minutes.";
                errorMessage.style.display = "block";
                successMessage.style.display = "none";
                return;
            }

            const adhocData = {
                login,
                activityName,
                date,
                duration
            };

            let pastAdhocs = JSON.parse(localStorage.getItem('adhocData')) || [];
            pastAdhocs.push(adhocData);
            localStorage.setItem('adhocData', JSON.stringify(pastAdhocs));

            successMessage.textContent = 'Adhoc data saved successfully!';
            successMessage.style.display = "block";
            errorMessage.style.display = "none";

            document.getElementById('adhocForm').reset();
        }
    </script>
</head>
<body>
    <header>
        <div class="container">
            <h1>Enter New Adhoc</h1>
        </div>
    </header>

    <main>
        <div class="container">
            <h2>Enter New Adhoc Details</h2>
            <form id="adhocForm" onsubmit="saveAdhocData(event);">
                <div class="form-group">
                    <label for="login">Login:</label>
                    <input type="text" id="login" name="login" required>
                </div>
                <div class="form-group">
                    <label for="activityName">Adhoc Activity Name:</label>
                    <input type="text" id="activityName" name="activityName" required>
                </div>
                <div class="form-group">
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                </div>
                <div class="form-group">
                    <label for="duration">Duration (Mins):</label>
                    <input type="text" id="duration" name="duration" required>
                </div>
                <div id="error-message" style="display: none; color: red;"></div>
                <div id="success-message" style="display: none; color: green;"></div>
                <input type="submit" value="Save Adhoc">
            </form>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 DRT Adhocs. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
